import{t as St}from"/numpy-tutorials/build/_shared/chunk-S2ZWKWBF.js";import"/numpy-tutorials/build/_shared/chunk-GHEGBPT5.js";import"/numpy-tutorials/build/_shared/chunk-7SAO57PG.js";import"/numpy-tutorials/build/_shared/chunk-UNB7NF4W.js";import{b as jn,c as J,d as me,f as vt,h as I,i as Fe,k as xt,n as Ce,o as De,q as Et,r as gt,s as Nt,t as _t,u as At,v as It,w as wt,x as Ft,y as Ct}from"/numpy-tutorials/build/_shared/chunk-M5KN76GI.js";import{a as Dt}from"/numpy-tutorials/build/_shared/chunk-OCWQY3HK.js";import{g as le,h as dt,i as ft,j as pt,k as ht,l as z}from"/numpy-tutorials/build/_shared/chunk-CVDX4WR7.js";import"/numpy-tutorials/build/_shared/chunk-3EBOCCHJ.js";import{b as kt}from"/numpy-tutorials/build/_shared/chunk-O4VQNZ62.js";import{B as Ie,E as we,b as ce,e as ct,h as ut,k as ue,s as Q,t as F,x as yt,y as bt}from"/numpy-tutorials/build/_shared/chunk-NK7RXO5Q.js";import{a as mt}from"/numpy-tutorials/build/_shared/chunk-GUCIBHGO.js";import{b as H,c as V,d as lt,f as at,g as st}from"/numpy-tutorials/build/_shared/chunk-OZE3FFNP.js";var zi,Ji,Zi,er,tr,nr,ke=H(()=>{me();me();J.once=function(e,t){return new Promise((n,r)=>{function l(...s){a!==void 0&&e.removeListener("error",a),n(s)}let a;t!=="error"&&(a=s=>{e.removeListener(name,l),r(s)},e.once("error",a)),e.once(t,l)})};J.on=function(e,t){let n=[],r=[],l=null,a=!1,s={async next(){let h=n.shift();if(h)return createIterResult(h,!1);if(l){let y=Promise.reject(l);return l=null,y}return a?createIterResult(void 0,!0):new Promise((y,b)=>r.push({resolve:y,reject:b}))},async return(){e.removeListener(t,d),e.removeListener("error",p),a=!0;for(let h of r)h.resolve(createIterResult(void 0,!0));return createIterResult(void 0,!0)},throw(h){l=h,e.removeListener(t,d),e.removeListener("error",p)},[Symbol.asyncIterator](){return this}};return e.on(t,d),e.on("error",p),s;function d(...h){let y=r.shift();y?y.resolve(createIterResult(h,!1)):n.push(h)}function p(h){a=!0;let y=r.shift();y?y.reject(h):l=h,s.return()}};({EventEmitter:zi,defaultMaxListeners:Ji,init:Zi,listenerCount:er,on:tr,once:nr}=J)});function Mn(){if(Tt)return Se;Tt=!0,Se=n;var e=J.EventEmitter,t=Et();t(n,e),n.Readable=At(),n.Writable=gt(),n.Duplex=Nt(),n.Transform=It(),n.PassThrough=wt(),n.finished=_t(),n.pipeline=Ft(),n.Stream=n;function n(){e.call(this||Te)}return n.prototype.pipe=function(r,l){var a=this||Te;function s(_){r.writable&&r.write(_)===!1&&a.pause&&a.pause()}a.on("data",s);function d(){a.readable&&a.resume&&a.resume()}r.on("drain",d),!r._isStdio&&(!l||l.end!==!1)&&(a.on("end",h),a.on("close",y));var p=!1;function h(){p||(p=!0,r.end())}function y(){p||(p=!0,typeof r.destroy=="function"&&r.destroy())}function b(_){if(x(),e.listenerCount(this||Te,"error")===0)throw _}a.on("error",b),r.on("error",b);function x(){a.removeListener("data",s),r.removeListener("drain",d),a.removeListener("end",h),a.removeListener("close",y),a.removeListener("error",b),r.removeListener("error",b),a.removeListener("end",x),a.removeListener("close",x),r.removeListener("close",x)}return a.on("end",x),a.on("close",x),r.on("close",x),r.emit("pipe",a),r},Se}var Se,Tt,Te,M,Oe=H(()=>{ke();Ct();me();Se={},Tt=!1,Te=typeof globalThis<"u"?globalThis:typeof self<"u"?self:globalThis;M=Mn()});var dr,fr,pr,hr,yr,br,vr,xr,Er,gr,Nr,_r,Ar,Ir,wr,Fr,Cr,Dr,kr,Sr,Tr,Or,Pr,Pe,Lr,Kr,Rr,Ot=H(()=>{xt();Fe();Fe();vt();dr=I._extend,fr=I.callbackify,pr=I.debuglog,hr=I.deprecate,yr=I.format,br=I.inherits,vr=I.inspect,xr=I.isArray,Er=I.isBoolean,gr=I.isBuffer,Nr=I.isDate,_r=I.isError,Ar=I.isFunction,Ir=I.isNull,wr=I.isNullOrUndefined,Fr=I.isNumber,Cr=I.isObject,Dr=I.isPrimitive,kr=I.isRegExp,Sr=I.isString,Tr=I.isSymbol,Or=I.isUndefined,Pr=I.log,Pe=I.promisify,Lr=I.types,Kr=I.TextEncoder=globalThis.TextEncoder,Rr=I.TextDecoder=globalThis.TextDecoder});var Le,Bn,Un,Gn,qn,$n,Vn,Xn,Wn,Pt=H(()=>{Oe();Oe();Ot();ke();me();Ct();xt();Fe();vt();jn();De();Le=M.Readable;Le.wrap=function(e,t){return t=Object.assign({objectMode:e.readableObjectMode!=null||e.objectMode!=null||!0},t),t.destroy=function(n,r){e.destroy(n),r(n)},new Le(t).wrap(e)};Bn=M.Writable,Un=M.Duplex,Gn=M.Transform,qn=M.PassThrough,$n=M.finished,Vn=M.pipeline,Xn=M.Stream,Wn={finished:Pe(M.finished),pipeline:Pe(M.pipeline)}});var Lt={};lt(Lt,{Duplex:()=>Un,PassThrough:()=>qn,Readable:()=>Le,Stream:()=>Xn,Transform:()=>Gn,Writable:()=>Bn,finished:()=>$n,pipeline:()=>Vn,promises:()=>Wn});var Kt=H(()=>{Pt()});var Yn,Rt=H(()=>{De();De();Yn=Ce.StringDecoder});var jt={};lt(jt,{StringDecoder:()=>Yn});var Mt=H(()=>{Rt()});var Bt=V(de=>{(function(e){e.parser=function(o,i){return new n(o,i)},e.SAXParser=n,e.SAXStream=h,e.createStream=p,e.MAX_BUFFER_LENGTH=64*1024;var t=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function n(o,i){if(!(this instanceof n))return new n(o,i);var f=this;l(f),f.q=f.c="",f.bufferCheckPosition=e.MAX_BUFFER_LENGTH,f.opt=i||{},f.opt.lowercase=f.opt.lowercase||f.opt.lowercasetags,f.looseCase=f.opt.lowercase?"toLowerCase":"toUpperCase",f.tags=[],f.closed=f.closedRoot=f.sawRoot=!1,f.tag=f.error=null,f.strict=!!o,f.noscript=!!(o||f.opt.noscript),f.state=u.BEGIN,f.strictEntities=f.opt.strictEntities,f.ENTITIES=f.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),f.attribList=[],f.opt.xmlns&&(f.ns=Object.create(O)),f.opt.unquotedAttributeValues===void 0&&(f.opt.unquotedAttributeValues=!o),f.trackPosition=f.opt.position!==!1,f.trackPosition&&(f.position=f.line=f.column=0),ie(f,"onready")}Object.create||(Object.create=function(o){function i(){}i.prototype=o;var f=new i;return f}),Object.keys||(Object.keys=function(o){var i=[];for(var f in o)o.hasOwnProperty(f)&&i.push(f);return i});function r(o){for(var i=Math.max(e.MAX_BUFFER_LENGTH,10),f=0,c=0,A=t.length;c<A;c++){var S=o[t[c]].length;if(S>i)switch(t[c]){case"textNode":re(o);break;case"cdata":C(o,"oncdata",o.cdata),o.cdata="";break;case"script":C(o,"onscript",o.script),o.script="";break;default:oe(o,"Max buffer length exceeded: "+t[c])}f=Math.max(f,S)}var T=e.MAX_BUFFER_LENGTH-f;o.bufferCheckPosition=T+o.position}function l(o){for(var i=0,f=t.length;i<f;i++)o[t[i]]=""}function a(o){re(o),o.cdata!==""&&(C(o,"oncdata",o.cdata),o.cdata=""),o.script!==""&&(C(o,"onscript",o.script),o.script="")}n.prototype={end:function(){tt(this)},write:Kn,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){a(this)}};var s;try{s=(Kt(),st(Lt)).Stream}catch{s=function(){}}s||(s=function(){});var d=e.EVENTS.filter(function(o){return o!=="error"&&o!=="end"});function p(o,i){return new h(o,i)}function h(o,i){if(!(this instanceof h))return new h(o,i);s.apply(this),this._parser=new n(o,i),this.writable=!0,this.readable=!0;var f=this;this._parser.onend=function(){f.emit("end")},this._parser.onerror=function(c){f.emit("error",c),f._parser.error=null},this._decoder=null,d.forEach(function(c){Object.defineProperty(f,"on"+c,{get:function(){return f._parser["on"+c]},set:function(A){if(!A)return f.removeAllListeners(c),f._parser["on"+c]=A,A;f.on(c,A)},enumerable:!0,configurable:!1})})}h.prototype=Object.create(s.prototype,{constructor:{value:h}}),h.prototype.write=function(o){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(o)){if(!this._decoder){var i=(Mt(),st(jt)).StringDecoder;this._decoder=new i("utf8")}o=this._decoder.write(o)}return this._parser.write(o.toString()),this.emit("data",o),!0},h.prototype.end=function(o){return o&&o.length&&this.write(o),this._parser.end(),!0},h.prototype.on=function(o,i){var f=this;return!f._parser["on"+o]&&d.indexOf(o)!==-1&&(f._parser["on"+o]=function(){var c=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);c.splice(0,0,o),f.emit.apply(f,c)}),s.prototype.on.call(f,o,i)};var y="[CDATA[",b="DOCTYPE",x="http://www.w3.org/XML/1998/namespace",_="http://www.w3.org/2000/xmlns/",O={xml:x,xmlns:_},E=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,D=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,G=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,W=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function k(o){return o===" "||o===`
`||o==="\r"||o==="	"}function se(o){return o==='"'||o==="'"}function Tn(o){return o===">"||k(o)}function q(o,i){return o.test(i)}function On(o,i){return!q(o,i)}var u=0;e.STATE={BEGIN:u++,BEGIN_WHITESPACE:u++,TEXT:u++,TEXT_ENTITY:u++,OPEN_WAKA:u++,SGML_DECL:u++,SGML_DECL_QUOTED:u++,DOCTYPE:u++,DOCTYPE_QUOTED:u++,DOCTYPE_DTD:u++,DOCTYPE_DTD_QUOTED:u++,COMMENT_STARTING:u++,COMMENT:u++,COMMENT_ENDING:u++,COMMENT_ENDED:u++,CDATA:u++,CDATA_ENDING:u++,CDATA_ENDING_2:u++,PROC_INST:u++,PROC_INST_BODY:u++,PROC_INST_ENDING:u++,OPEN_TAG:u++,OPEN_TAG_SLASH:u++,ATTRIB:u++,ATTRIB_NAME:u++,ATTRIB_NAME_SAW_WHITE:u++,ATTRIB_VALUE:u++,ATTRIB_VALUE_QUOTED:u++,ATTRIB_VALUE_CLOSED:u++,ATTRIB_VALUE_UNQUOTED:u++,ATTRIB_VALUE_ENTITY_Q:u++,ATTRIB_VALUE_ENTITY_U:u++,CLOSE_TAG:u++,CLOSE_TAG_SAW_WHITE:u++,SCRIPT:u++,SCRIPT_ENDING:u++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(o){var i=e.ENTITIES[o],f=typeof i=="number"?String.fromCharCode(i):i;e.ENTITIES[o]=f});for(var Ze in e.STATE)e.STATE[e.STATE[Ze]]=Ze;u=e.STATE;function ie(o,i,f){o[i]&&o[i](f)}function C(o,i,f){o.textNode&&re(o),ie(o,i,f)}function re(o){o.textNode=et(o.opt,o.textNode),o.textNode&&ie(o,"ontext",o.textNode),o.textNode=""}function et(o,i){return o.trim&&(i=i.trim()),o.normalize&&(i=i.replace(/\s+/g," ")),i}function oe(o,i){return re(o),o.trackPosition&&(i+=`
Line: `+o.line+`
Column: `+o.column+`
Char: `+o.c),i=new Error(i),o.error=i,ie(o,"onerror",i),o}function tt(o){return o.sawRoot&&!o.closedRoot&&w(o,"Unclosed root tag"),o.state!==u.BEGIN&&o.state!==u.BEGIN_WHITESPACE&&o.state!==u.TEXT&&oe(o,"Unexpected end"),re(o),o.c="",o.closed=!0,ie(o,"onend"),n.call(o,o.strict,o.opt),o}function w(o,i){if(typeof o!="object"||!(o instanceof n))throw new Error("bad call to strictFail");o.strict&&oe(o,i)}function Pn(o){o.strict||(o.tagName=o.tagName[o.looseCase]());var i=o.tags[o.tags.length-1]||o,f=o.tag={name:o.tagName,attributes:{}};o.opt.xmlns&&(f.ns=i.ns),o.attribList.length=0,C(o,"onopentagstart",f)}function ge(o,i){var f=o.indexOf(":"),c=f<0?["",o]:o.split(":"),A=c[0],S=c[1];return i&&o==="xmlns"&&(A="xmlns",S=""),{prefix:A,local:S}}function Ne(o){if(o.strict||(o.attribName=o.attribName[o.looseCase]()),o.attribList.indexOf(o.attribName)!==-1||o.tag.attributes.hasOwnProperty(o.attribName)){o.attribName=o.attribValue="";return}if(o.opt.xmlns){var i=ge(o.attribName,!0),f=i.prefix,c=i.local;if(f==="xmlns")if(c==="xml"&&o.attribValue!==x)w(o,"xml: prefix must be bound to "+x+`
Actual: `+o.attribValue);else if(c==="xmlns"&&o.attribValue!==_)w(o,"xmlns: prefix must be bound to "+_+`
Actual: `+o.attribValue);else{var A=o.tag,S=o.tags[o.tags.length-1]||o;A.ns===S.ns&&(A.ns=Object.create(S.ns)),A.ns[c]=o.attribValue}o.attribList.push([o.attribName,o.attribValue])}else o.tag.attributes[o.attribName]=o.attribValue,C(o,"onattribute",{name:o.attribName,value:o.attribValue});o.attribName=o.attribValue=""}function Y(o,i){if(o.opt.xmlns){var f=o.tag,c=ge(o.tagName);f.prefix=c.prefix,f.local=c.local,f.uri=f.ns[c.prefix]||"",f.prefix&&!f.uri&&(w(o,"Unbound namespace prefix: "+JSON.stringify(o.tagName)),f.uri=c.prefix);var A=o.tags[o.tags.length-1]||o;f.ns&&A.ns!==f.ns&&Object.keys(f.ns).forEach(function(ot){C(o,"onopennamespace",{prefix:ot,uri:f.ns[ot]})});for(var S=0,T=o.attribList.length;S<T;S++){var R=o.attribList[S],j=R[0],Z=R[1],P=ge(j,!0),$=P.prefix,Rn=P.local,rt=$===""?"":f.ns[$]||"",Ae={name:j,value:Z,prefix:$,local:Rn,uri:rt};$&&$!=="xmlns"&&!rt&&(w(o,"Unbound namespace prefix: "+JSON.stringify($)),Ae.uri=$),o.tag.attributes[j]=Ae,C(o,"onattribute",Ae)}o.attribList.length=0}o.tag.isSelfClosing=!!i,o.sawRoot=!0,o.tags.push(o.tag),C(o,"onopentag",o.tag),i||(!o.noscript&&o.tagName.toLowerCase()==="script"?o.state=u.SCRIPT:o.state=u.TEXT,o.tag=null,o.tagName=""),o.attribName=o.attribValue="",o.attribList.length=0}function _e(o){if(!o.tagName){w(o,"Weird empty close tag."),o.textNode+="</>",o.state=u.TEXT;return}if(o.script){if(o.tagName!=="script"){o.script+="</"+o.tagName+">",o.tagName="",o.state=u.SCRIPT;return}C(o,"onscript",o.script),o.script=""}var i=o.tags.length,f=o.tagName;o.strict||(f=f[o.looseCase]());for(var c=f;i--;){var A=o.tags[i];if(A.name!==c)w(o,"Unexpected close tag");else break}if(i<0){w(o,"Unmatched closing tag: "+o.tagName),o.textNode+="</"+o.tagName+">",o.state=u.TEXT;return}o.tagName=f;for(var S=o.tags.length;S-- >i;){var T=o.tag=o.tags.pop();o.tagName=o.tag.name,C(o,"onclosetag",o.tagName);var R={};for(var j in T.ns)R[j]=T.ns[j];var Z=o.tags[o.tags.length-1]||o;o.opt.xmlns&&T.ns!==Z.ns&&Object.keys(T.ns).forEach(function(P){var $=T.ns[P];C(o,"onclosenamespace",{prefix:P,uri:$})})}i===0&&(o.closedRoot=!0),o.tagName=o.attribValue=o.attribName="",o.attribList.length=0,o.state=u.TEXT}function Ln(o){var i=o.entity,f=i.toLowerCase(),c,A="";return o.ENTITIES[i]?o.ENTITIES[i]:o.ENTITIES[f]?o.ENTITIES[f]:(i=f,i.charAt(0)==="#"&&(i.charAt(1)==="x"?(i=i.slice(2),c=parseInt(i,16),A=c.toString(16)):(i=i.slice(1),c=parseInt(i,10),A=c.toString(10))),i=i.replace(/^0+/,""),isNaN(c)||A.toLowerCase()!==i?(w(o,"Invalid character entity"),"&"+o.entity+";"):String.fromCodePoint(c))}function nt(o,i){i==="<"?(o.state=u.OPEN_WAKA,o.startTagPosition=o.position):k(i)||(w(o,"Non-whitespace before first tag."),o.textNode=i,o.state=u.TEXT)}function it(o,i){var f="";return i<o.length&&(f=o.charAt(i)),f}function Kn(o){var i=this;if(this.error)throw this.error;if(i.closed)return oe(i,"Cannot write after close. Assign an onready handler.");if(o===null)return tt(i);typeof o=="object"&&(o=o.toString());for(var f=0,c="";c=it(o,f++),i.c=c,!!c;)switch(i.trackPosition&&(i.position++,c===`
`?(i.line++,i.column=0):i.column++),i.state){case u.BEGIN:if(i.state=u.BEGIN_WHITESPACE,c==="\uFEFF")continue;nt(i,c);continue;case u.BEGIN_WHITESPACE:nt(i,c);continue;case u.TEXT:if(i.sawRoot&&!i.closedRoot){for(var A=f-1;c&&c!=="<"&&c!=="&";)c=it(o,f++),c&&i.trackPosition&&(i.position++,c===`
`?(i.line++,i.column=0):i.column++);i.textNode+=o.substring(A,f-1)}c==="<"&&!(i.sawRoot&&i.closedRoot&&!i.strict)?(i.state=u.OPEN_WAKA,i.startTagPosition=i.position):(!k(c)&&(!i.sawRoot||i.closedRoot)&&w(i,"Text data outside of root node."),c==="&"?i.state=u.TEXT_ENTITY:i.textNode+=c);continue;case u.SCRIPT:c==="<"?i.state=u.SCRIPT_ENDING:i.script+=c;continue;case u.SCRIPT_ENDING:c==="/"?i.state=u.CLOSE_TAG:(i.script+="<"+c,i.state=u.SCRIPT);continue;case u.OPEN_WAKA:if(c==="!")i.state=u.SGML_DECL,i.sgmlDecl="";else if(!k(c))if(q(E,c))i.state=u.OPEN_TAG,i.tagName=c;else if(c==="/")i.state=u.CLOSE_TAG,i.tagName="";else if(c==="?")i.state=u.PROC_INST,i.procInstName=i.procInstBody="";else{if(w(i,"Unencoded <"),i.startTagPosition+1<i.position){var S=i.position-i.startTagPosition;c=new Array(S).join(" ")+c}i.textNode+="<"+c,i.state=u.TEXT}continue;case u.SGML_DECL:if(i.sgmlDecl+c==="--"){i.state=u.COMMENT,i.comment="",i.sgmlDecl="";continue}i.doctype&&i.doctype!==!0&&i.sgmlDecl?(i.state=u.DOCTYPE_DTD,i.doctype+="<!"+i.sgmlDecl+c,i.sgmlDecl=""):(i.sgmlDecl+c).toUpperCase()===y?(C(i,"onopencdata"),i.state=u.CDATA,i.sgmlDecl="",i.cdata=""):(i.sgmlDecl+c).toUpperCase()===b?(i.state=u.DOCTYPE,(i.doctype||i.sawRoot)&&w(i,"Inappropriately located doctype declaration"),i.doctype="",i.sgmlDecl=""):c===">"?(C(i,"onsgmldeclaration",i.sgmlDecl),i.sgmlDecl="",i.state=u.TEXT):(se(c)&&(i.state=u.SGML_DECL_QUOTED),i.sgmlDecl+=c);continue;case u.SGML_DECL_QUOTED:c===i.q&&(i.state=u.SGML_DECL,i.q=""),i.sgmlDecl+=c;continue;case u.DOCTYPE:c===">"?(i.state=u.TEXT,C(i,"ondoctype",i.doctype),i.doctype=!0):(i.doctype+=c,c==="["?i.state=u.DOCTYPE_DTD:se(c)&&(i.state=u.DOCTYPE_QUOTED,i.q=c));continue;case u.DOCTYPE_QUOTED:i.doctype+=c,c===i.q&&(i.q="",i.state=u.DOCTYPE);continue;case u.DOCTYPE_DTD:c==="]"?(i.doctype+=c,i.state=u.DOCTYPE):c==="<"?(i.state=u.OPEN_WAKA,i.startTagPosition=i.position):se(c)?(i.doctype+=c,i.state=u.DOCTYPE_DTD_QUOTED,i.q=c):i.doctype+=c;continue;case u.DOCTYPE_DTD_QUOTED:i.doctype+=c,c===i.q&&(i.state=u.DOCTYPE_DTD,i.q="");continue;case u.COMMENT:c==="-"?i.state=u.COMMENT_ENDING:i.comment+=c;continue;case u.COMMENT_ENDING:c==="-"?(i.state=u.COMMENT_ENDED,i.comment=et(i.opt,i.comment),i.comment&&C(i,"oncomment",i.comment),i.comment=""):(i.comment+="-"+c,i.state=u.COMMENT);continue;case u.COMMENT_ENDED:c!==">"?(w(i,"Malformed comment"),i.comment+="--"+c,i.state=u.COMMENT):i.doctype&&i.doctype!==!0?i.state=u.DOCTYPE_DTD:i.state=u.TEXT;continue;case u.CDATA:c==="]"?i.state=u.CDATA_ENDING:i.cdata+=c;continue;case u.CDATA_ENDING:c==="]"?i.state=u.CDATA_ENDING_2:(i.cdata+="]"+c,i.state=u.CDATA);continue;case u.CDATA_ENDING_2:c===">"?(i.cdata&&C(i,"oncdata",i.cdata),C(i,"onclosecdata"),i.cdata="",i.state=u.TEXT):c==="]"?i.cdata+="]":(i.cdata+="]]"+c,i.state=u.CDATA);continue;case u.PROC_INST:c==="?"?i.state=u.PROC_INST_ENDING:k(c)?i.state=u.PROC_INST_BODY:i.procInstName+=c;continue;case u.PROC_INST_BODY:if(!i.procInstBody&&k(c))continue;c==="?"?i.state=u.PROC_INST_ENDING:i.procInstBody+=c;continue;case u.PROC_INST_ENDING:c===">"?(C(i,"onprocessinginstruction",{name:i.procInstName,body:i.procInstBody}),i.procInstName=i.procInstBody="",i.state=u.TEXT):(i.procInstBody+="?"+c,i.state=u.PROC_INST_BODY);continue;case u.OPEN_TAG:q(D,c)?i.tagName+=c:(Pn(i),c===">"?Y(i):c==="/"?i.state=u.OPEN_TAG_SLASH:(k(c)||w(i,"Invalid character in tag name"),i.state=u.ATTRIB));continue;case u.OPEN_TAG_SLASH:c===">"?(Y(i,!0),_e(i)):(w(i,"Forward-slash in opening tag not followed by >"),i.state=u.ATTRIB);continue;case u.ATTRIB:if(k(c))continue;c===">"?Y(i):c==="/"?i.state=u.OPEN_TAG_SLASH:q(E,c)?(i.attribName=c,i.attribValue="",i.state=u.ATTRIB_NAME):w(i,"Invalid attribute name");continue;case u.ATTRIB_NAME:c==="="?i.state=u.ATTRIB_VALUE:c===">"?(w(i,"Attribute without value"),i.attribValue=i.attribName,Ne(i),Y(i)):k(c)?i.state=u.ATTRIB_NAME_SAW_WHITE:q(D,c)?i.attribName+=c:w(i,"Invalid attribute name");continue;case u.ATTRIB_NAME_SAW_WHITE:if(c==="=")i.state=u.ATTRIB_VALUE;else{if(k(c))continue;w(i,"Attribute without value"),i.tag.attributes[i.attribName]="",i.attribValue="",C(i,"onattribute",{name:i.attribName,value:""}),i.attribName="",c===">"?Y(i):q(E,c)?(i.attribName=c,i.state=u.ATTRIB_NAME):(w(i,"Invalid attribute name"),i.state=u.ATTRIB)}continue;case u.ATTRIB_VALUE:if(k(c))continue;se(c)?(i.q=c,i.state=u.ATTRIB_VALUE_QUOTED):(i.opt.unquotedAttributeValues||oe(i,"Unquoted attribute value"),i.state=u.ATTRIB_VALUE_UNQUOTED,i.attribValue=c);continue;case u.ATTRIB_VALUE_QUOTED:if(c!==i.q){c==="&"?i.state=u.ATTRIB_VALUE_ENTITY_Q:i.attribValue+=c;continue}Ne(i),i.q="",i.state=u.ATTRIB_VALUE_CLOSED;continue;case u.ATTRIB_VALUE_CLOSED:k(c)?i.state=u.ATTRIB:c===">"?Y(i):c==="/"?i.state=u.OPEN_TAG_SLASH:q(E,c)?(w(i,"No whitespace between attributes"),i.attribName=c,i.attribValue="",i.state=u.ATTRIB_NAME):w(i,"Invalid attribute name");continue;case u.ATTRIB_VALUE_UNQUOTED:if(!Tn(c)){c==="&"?i.state=u.ATTRIB_VALUE_ENTITY_U:i.attribValue+=c;continue}Ne(i),c===">"?Y(i):i.state=u.ATTRIB;continue;case u.CLOSE_TAG:if(i.tagName)c===">"?_e(i):q(D,c)?i.tagName+=c:i.script?(i.script+="</"+i.tagName,i.tagName="",i.state=u.SCRIPT):(k(c)||w(i,"Invalid tagname in closing tag"),i.state=u.CLOSE_TAG_SAW_WHITE);else{if(k(c))continue;On(E,c)?i.script?(i.script+="</"+c,i.state=u.SCRIPT):w(i,"Invalid tagname in closing tag."):i.tagName=c}continue;case u.CLOSE_TAG_SAW_WHITE:if(k(c))continue;c===">"?_e(i):w(i,"Invalid characters in closing tag");continue;case u.TEXT_ENTITY:case u.ATTRIB_VALUE_ENTITY_Q:case u.ATTRIB_VALUE_ENTITY_U:var T,R;switch(i.state){case u.TEXT_ENTITY:T=u.TEXT,R="textNode";break;case u.ATTRIB_VALUE_ENTITY_Q:T=u.ATTRIB_VALUE_QUOTED,R="attribValue";break;case u.ATTRIB_VALUE_ENTITY_U:T=u.ATTRIB_VALUE_UNQUOTED,R="attribValue";break}if(c===";"){var j=Ln(i);i.opt.unparsedEntities&&!Object.values(e.XML_ENTITIES).includes(j)?(i.entity="",i.state=T,i.write(j)):(i[R]+=j,i.entity="",i.state=T)}else q(i.entity.length?W:G,c)?i.entity+=c:(w(i,"Invalid character in entity name"),i[R]+="&"+i.entity+c,i.entity="",i.state=T);continue;default:throw new Error(i,"Unknown state: "+i.state)}return i.position>=i.bufferCheckPosition&&r(i),i}String.fromCodePoint||function(){var o=String.fromCharCode,i=Math.floor,f=function(){var c=16384,A=[],S,T,R=-1,j=arguments.length;if(!j)return"";for(var Z="";++R<j;){var P=Number(arguments[R]);if(!isFinite(P)||P<0||P>1114111||i(P)!==P)throw RangeError("Invalid code point: "+P);P<=65535?A.push(P):(P-=65536,S=(P>>10)+55296,T=P%1024+56320,A.push(S,T)),(R+1===j||A.length>c)&&(Z+=o.apply(null,A),A.length=0)}return Z};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:f,configurable:!0,writable:!0}):String.fromCodePoint=f}()})(typeof de>"u"?de.sax={}:de)});var fe=V((ro,Ut)=>{Ut.exports={isArray:function(e){return Array.isArray?Array.isArray(e):Object.prototype.toString.call(e)==="[object Array]"}}});var pe=V((oo,Gt)=>{var Hn=fe().isArray;Gt.exports={copyOptions:function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n},ensureFlagExists:function(e,t){(!(e in t)||typeof t[e]!="boolean")&&(t[e]=!1)},ensureSpacesExists:function(e){(!("spaces"in e)||typeof e.spaces!="number"&&typeof e.spaces!="string")&&(e.spaces=0)},ensureAlwaysArrayExists:function(e){(!("alwaysArray"in e)||typeof e.alwaysArray!="boolean"&&!Hn(e.alwaysArray))&&(e.alwaysArray=!1)},ensureKeyExists:function(e,t){(!(e+"Key"in t)||typeof t[e+"Key"]!="string")&&(t[e+"Key"]=t.compact?"_"+e:e)},checkFnExists:function(e,t){return e+"Fn"in t}}});var Re=V((lo,Qt)=>{var Qn=Bt(),zn={on:function(){},parse:function(){}},g=pe(),ee=fe().isArray,m,Ke=!0,v;function Jn(e){return m=g.copyOptions(e),g.ensureFlagExists("ignoreDeclaration",m),g.ensureFlagExists("ignoreInstruction",m),g.ensureFlagExists("ignoreAttributes",m),g.ensureFlagExists("ignoreText",m),g.ensureFlagExists("ignoreComment",m),g.ensureFlagExists("ignoreCdata",m),g.ensureFlagExists("ignoreDoctype",m),g.ensureFlagExists("compact",m),g.ensureFlagExists("alwaysChildren",m),g.ensureFlagExists("addParent",m),g.ensureFlagExists("trim",m),g.ensureFlagExists("nativeType",m),g.ensureFlagExists("nativeTypeAttributes",m),g.ensureFlagExists("sanitize",m),g.ensureFlagExists("instructionHasAttributes",m),g.ensureFlagExists("captureSpacesBetweenElements",m),g.ensureAlwaysArrayExists(m),g.ensureKeyExists("declaration",m),g.ensureKeyExists("instruction",m),g.ensureKeyExists("attributes",m),g.ensureKeyExists("text",m),g.ensureKeyExists("comment",m),g.ensureKeyExists("cdata",m),g.ensureKeyExists("doctype",m),g.ensureKeyExists("type",m),g.ensureKeyExists("name",m),g.ensureKeyExists("elements",m),g.ensureKeyExists("parent",m),g.checkFnExists("doctype",m),g.checkFnExists("instruction",m),g.checkFnExists("cdata",m),g.checkFnExists("comment",m),g.checkFnExists("text",m),g.checkFnExists("instructionName",m),g.checkFnExists("elementName",m),g.checkFnExists("attributeName",m),g.checkFnExists("attributeValue",m),g.checkFnExists("attributes",m),m}function Yt(e){var t=Number(e);if(!isNaN(t))return t;var n=e.toLowerCase();return n==="true"?!0:n==="false"?!1:e}function ae(e,t){var n;if(m.compact){if(!v[m[e+"Key"]]&&(ee(m.alwaysArray)?m.alwaysArray.indexOf(m[e+"Key"])!==-1:m.alwaysArray)&&(v[m[e+"Key"]]=[]),v[m[e+"Key"]]&&!ee(v[m[e+"Key"]])&&(v[m[e+"Key"]]=[v[m[e+"Key"]]]),e+"Fn"in m&&typeof t=="string"&&(t=m[e+"Fn"](t,v)),e==="instruction"&&("instructionFn"in m||"instructionNameFn"in m)){for(n in t)if(t.hasOwnProperty(n))if("instructionFn"in m)t[n]=m.instructionFn(t[n],n,v);else{var r=t[n];delete t[n],t[m.instructionNameFn(n,r,v)]=r}}ee(v[m[e+"Key"]])?v[m[e+"Key"]].push(t):v[m[e+"Key"]]=t}else{v[m.elementsKey]||(v[m.elementsKey]=[]);var l={};if(l[m.typeKey]=e,e==="instruction"){for(n in t)if(t.hasOwnProperty(n))break;l[m.nameKey]="instructionNameFn"in m?m.instructionNameFn(n,t,v):n,m.instructionHasAttributes?(l[m.attributesKey]=t[n][m.attributesKey],"instructionFn"in m&&(l[m.attributesKey]=m.instructionFn(l[m.attributesKey],n,v))):("instructionFn"in m&&(t[n]=m.instructionFn(t[n],n,v)),l[m.instructionKey]=t[n])}else e+"Fn"in m&&(t=m[e+"Fn"](t,v)),l[m[e+"Key"]]=t;m.addParent&&(l[m.parentKey]=v),v[m.elementsKey].push(l)}}function Ht(e){if("attributesFn"in m&&e&&(e=m.attributesFn(e,v)),(m.trim||"attributeValueFn"in m||"attributeNameFn"in m||m.nativeTypeAttributes)&&e){var t;for(t in e)if(e.hasOwnProperty(t)&&(m.trim&&(e[t]=e[t].trim()),m.nativeTypeAttributes&&(e[t]=Yt(e[t])),"attributeValueFn"in m&&(e[t]=m.attributeValueFn(e[t],t,v)),"attributeNameFn"in m)){var n=e[t];delete e[t],e[m.attributeNameFn(t,e[t],v)]=n}}return e}function Zn(e){var t={};if(e.body&&(e.name.toLowerCase()==="xml"||m.instructionHasAttributes)){for(var n=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,r;(r=n.exec(e.body))!==null;)t[r[1]]=r[2]||r[3]||r[4];t=Ht(t)}if(e.name.toLowerCase()==="xml"){if(m.ignoreDeclaration)return;v[m.declarationKey]={},Object.keys(t).length&&(v[m.declarationKey][m.attributesKey]=t),m.addParent&&(v[m.declarationKey][m.parentKey]=v)}else{if(m.ignoreInstruction)return;m.trim&&(e.body=e.body.trim());var l={};m.instructionHasAttributes&&Object.keys(t).length?(l[e.name]={},l[e.name][m.attributesKey]=t):l[e.name]=e.body,ae("instruction",l)}}function qt(e,t){var n;if(typeof e=="object"&&(t=e.attributes,e=e.name),t=Ht(t),"elementNameFn"in m&&(e=m.elementNameFn(e,v)),m.compact){if(n={},!m.ignoreAttributes&&t&&Object.keys(t).length){n[m.attributesKey]={};var r;for(r in t)t.hasOwnProperty(r)&&(n[m.attributesKey][r]=t[r])}!(e in v)&&(ee(m.alwaysArray)?m.alwaysArray.indexOf(e)!==-1:m.alwaysArray)&&(v[e]=[]),v[e]&&!ee(v[e])&&(v[e]=[v[e]]),ee(v[e])?v[e].push(n):v[e]=n}else v[m.elementsKey]||(v[m.elementsKey]=[]),n={},n[m.typeKey]="element",n[m.nameKey]=e,!m.ignoreAttributes&&t&&Object.keys(t).length&&(n[m.attributesKey]=t),m.alwaysChildren&&(n[m.elementsKey]=[]),v[m.elementsKey].push(n);n[m.parentKey]=v,v=n}function $t(e){m.ignoreText||!e.trim()&&!m.captureSpacesBetweenElements||(m.trim&&(e=e.trim()),m.nativeType&&(e=Yt(e)),m.sanitize&&(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),ae("text",e))}function Vt(e){m.ignoreComment||(m.trim&&(e=e.trim()),ae("comment",e))}function Xt(e){var t=v[m.parentKey];m.addParent||delete v[m.parentKey],v=t}function ei(e){m.ignoreCdata||(m.trim&&(e=e.trim()),ae("cdata",e))}function ti(e){m.ignoreDoctype||(e=e.replace(/^ /,""),m.trim&&(e=e.trim()),ae("doctype",e))}function Wt(e){e.note=e}Qt.exports=function(e,t){var n=Ke?Qn.parser(!0,{}):n=new zn.Parser("UTF-8"),r={};if(v=r,m=Jn(t),Ke?(n.opt={strictEntities:!0},n.onopentag=qt,n.ontext=$t,n.oncomment=Vt,n.onclosetag=Xt,n.onerror=Wt,n.oncdata=ei,n.ondoctype=ti,n.onprocessinginstruction=Zn):(n.on("startElement",qt),n.on("text",$t),n.on("comment",Vt),n.on("endElement",Xt),n.on("error",Wt)),Ke)n.write(e).close();else if(!n.parse(e))throw new Error("XML parsing error: "+n.getError());if(r[m.elementsKey]){var l=r[m.elementsKey];delete r[m.elementsKey],r[m.elementsKey]=l,delete r.text}return r}});var Zt=V((ao,Jt)=>{var zt=pe(),ni=Re();function ii(e){var t=zt.copyOptions(e);return zt.ensureSpacesExists(t),t}Jt.exports=function(e,t){var n,r,l,a;return n=ii(t),r=ni(e,n),a="compact"in n&&n.compact?"_parent":"parent","addParent"in n&&n.addParent?l=JSON.stringify(r,function(s,d){return s===a?"_":d},n.spaces):l=JSON.stringify(r,null,n.spaces),l.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}});var Me=V((so,cn)=>{var N=pe(),ri=fe().isArray,L,K;function oi(e){var t=N.copyOptions(e);return N.ensureFlagExists("ignoreDeclaration",t),N.ensureFlagExists("ignoreInstruction",t),N.ensureFlagExists("ignoreAttributes",t),N.ensureFlagExists("ignoreText",t),N.ensureFlagExists("ignoreComment",t),N.ensureFlagExists("ignoreCdata",t),N.ensureFlagExists("ignoreDoctype",t),N.ensureFlagExists("compact",t),N.ensureFlagExists("indentText",t),N.ensureFlagExists("indentCdata",t),N.ensureFlagExists("indentAttributes",t),N.ensureFlagExists("indentInstruction",t),N.ensureFlagExists("fullTagEmptyElement",t),N.ensureFlagExists("noQuotesForNativeAttributes",t),N.ensureSpacesExists(t),typeof t.spaces=="number"&&(t.spaces=Array(t.spaces+1).join(" ")),N.ensureKeyExists("declaration",t),N.ensureKeyExists("instruction",t),N.ensureKeyExists("attributes",t),N.ensureKeyExists("text",t),N.ensureKeyExists("comment",t),N.ensureKeyExists("cdata",t),N.ensureKeyExists("doctype",t),N.ensureKeyExists("type",t),N.ensureKeyExists("name",t),N.ensureKeyExists("elements",t),N.checkFnExists("doctype",t),N.checkFnExists("instruction",t),N.checkFnExists("cdata",t),N.checkFnExists("comment",t),N.checkFnExists("text",t),N.checkFnExists("instructionName",t),N.checkFnExists("elementName",t),N.checkFnExists("attributeName",t),N.checkFnExists("attributeValue",t),N.checkFnExists("attributes",t),N.checkFnExists("fullTagEmptyElement",t),t}function B(e,t,n){return(!n&&e.spaces?`
`:"")+Array(t+1).join(e.spaces)}function he(e,t,n){if(t.ignoreAttributes)return"";"attributesFn"in t&&(e=t.attributesFn(e,K,L));var r,l,a,s,d=[];for(r in e)e.hasOwnProperty(r)&&e[r]!==null&&e[r]!==void 0&&(s=t.noQuotesForNativeAttributes&&typeof e[r]!="string"?"":'"',l=""+e[r],l=l.replace(/"/g,"&quot;"),a="attributeNameFn"in t?t.attributeNameFn(r,l,K,L):r,d.push(t.spaces&&t.indentAttributes?B(t,n+1,!1):" "),d.push(a+"="+s+("attributeValueFn"in t?t.attributeValueFn(l,r,K,L):l)+s));return e&&Object.keys(e).length&&t.spaces&&t.indentAttributes&&d.push(B(t,n,!1)),d.join("")}function en(e,t,n){return L=e,K="xml",t.ignoreDeclaration?"":"<?xml"+he(e[t.attributesKey],t,n)+"?>"}function tn(e,t,n){if(t.ignoreInstruction)return"";var r;for(r in e)if(e.hasOwnProperty(r))break;var l="instructionNameFn"in t?t.instructionNameFn(r,e[r],K,L):r;if(typeof e[r]=="object")return L=e,K=l,"<?"+l+he(e[r][t.attributesKey],t,n)+"?>";var a=e[r]?e[r]:"";return"instructionFn"in t&&(a=t.instructionFn(a,r,K,L)),"<?"+l+(a?" "+a:"")+"?>"}function nn(e,t){return t.ignoreComment?"":"<!--"+("commentFn"in t?t.commentFn(e,K,L):e)+"-->"}function rn(e,t){return t.ignoreCdata?"":"<![CDATA["+("cdataFn"in t?t.cdataFn(e,K,L):e.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function on(e,t){return t.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in t?t.doctypeFn(e,K,L):e)+">"}function je(e,t){return t.ignoreText?"":(e=""+e,e=e.replace(/&amp;/g,"&"),e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in t?t.textFn(e,K,L):e)}function li(e,t){var n;if(e.elements&&e.elements.length)for(n=0;n<e.elements.length;++n)switch(e.elements[n][t.typeKey]){case"text":if(t.indentText)return!0;break;case"cdata":if(t.indentCdata)return!0;break;case"instruction":if(t.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function ai(e,t,n){L=e,K=e.name;var r=[],l="elementNameFn"in t?t.elementNameFn(e.name,e):e.name;r.push("<"+l),e[t.attributesKey]&&r.push(he(e[t.attributesKey],t,n));var a=e[t.elementsKey]&&e[t.elementsKey].length||e[t.attributesKey]&&e[t.attributesKey]["xml:space"]==="preserve";return a||("fullTagEmptyElementFn"in t?a=t.fullTagEmptyElementFn(e.name,e):a=t.fullTagEmptyElement),a?(r.push(">"),e[t.elementsKey]&&e[t.elementsKey].length&&(r.push(ln(e[t.elementsKey],t,n+1)),L=e,K=e.name),r.push(t.spaces&&li(e,t)?`
`+Array(n+1).join(t.spaces):""),r.push("</"+l+">")):r.push("/>"),r.join("")}function ln(e,t,n,r){return e.reduce(function(l,a){var s=B(t,n,r&&!l);switch(a.type){case"element":return l+s+ai(a,t,n);case"comment":return l+s+nn(a[t.commentKey],t);case"doctype":return l+s+on(a[t.doctypeKey],t);case"cdata":return l+(t.indentCdata?s:"")+rn(a[t.cdataKey],t);case"text":return l+(t.indentText?s:"")+je(a[t.textKey],t);case"instruction":var d={};return d[a[t.nameKey]]=a[t.attributesKey]?a:a[t.instructionKey],l+(t.indentInstruction?s:"")+tn(d,t,n)}},"")}function an(e,t,n){var r;for(r in e)if(e.hasOwnProperty(r))switch(r){case t.parentKey:case t.attributesKey:break;case t.textKey:if(t.indentText||n)return!0;break;case t.cdataKey:if(t.indentCdata||n)return!0;break;case t.instructionKey:if(t.indentInstruction||n)return!0;break;case t.doctypeKey:case t.commentKey:return!0;default:return!0}return!1}function si(e,t,n,r,l){L=e,K=t;var a="elementNameFn"in n?n.elementNameFn(t,e):t;if(typeof e>"u"||e===null||e==="")return"fullTagEmptyElementFn"in n&&n.fullTagEmptyElementFn(t,e)||n.fullTagEmptyElement?"<"+a+"></"+a+">":"<"+a+"/>";var s=[];if(t){if(s.push("<"+a),typeof e!="object")return s.push(">"+je(e,n)+"</"+a+">"),s.join("");e[n.attributesKey]&&s.push(he(e[n.attributesKey],n,r));var d=an(e,n,!0)||e[n.attributesKey]&&e[n.attributesKey]["xml:space"]==="preserve";if(d||("fullTagEmptyElementFn"in n?d=n.fullTagEmptyElementFn(t,e):d=n.fullTagEmptyElement),d)s.push(">");else return s.push("/>"),s.join("")}return s.push(sn(e,n,r+1,!1)),L=e,K=t,t&&s.push((l?B(n,r,!1):"")+"</"+a+">"),s.join("")}function sn(e,t,n,r){var l,a,s,d=[];for(a in e)if(e.hasOwnProperty(a))for(s=ri(e[a])?e[a]:[e[a]],l=0;l<s.length;++l){switch(a){case t.declarationKey:d.push(en(s[l],t,n));break;case t.instructionKey:d.push((t.indentInstruction?B(t,n,r):"")+tn(s[l],t,n));break;case t.attributesKey:case t.parentKey:break;case t.textKey:d.push((t.indentText?B(t,n,r):"")+je(s[l],t));break;case t.cdataKey:d.push((t.indentCdata?B(t,n,r):"")+rn(s[l],t));break;case t.doctypeKey:d.push(B(t,n,r)+on(s[l],t));break;case t.commentKey:d.push(B(t,n,r)+nn(s[l],t));break;default:d.push(B(t,n,r)+si(s[l],a,t,n,an(s[l],t)))}r=r&&!d.length}return d.join("")}cn.exports=function(e,t){t=oi(t);var n=[];return L=e,K="_root_",t.compact?n.push(sn(e,t,0,!0)):(e[t.declarationKey]&&n.push(en(e[t.declarationKey],t,0)),e[t.elementsKey]&&e[t.elementsKey].length&&n.push(ln(e[t.elementsKey],t,0,!n.length))),n.join("")}});var mn=V((co,un)=>{var ci=Me();un.exports=function(e,t){e instanceof Buffer&&(e=e.toString());var n=null;if(typeof e=="string")try{n=JSON.parse(e)}catch{throw new Error("The JSON structure is invalid")}else n=e;return ci(n,t)}});var Be=V((uo,dn)=>{var ui=Re(),mi=Zt(),di=Me(),fi=mn();dn.exports={xml2js:ui,xml2json:mi,js2xml:di,json2xml:fi}});var Dn=at(Be(),1);var ye;(function(e){e.abbrev="abbrev",e.abstract="abstract",e.accessDate="access-date",e.ack="ack",e.addrLine="addr-line",e.address="address",e.aff="aff",e.affAlternatives="aff-alternatives",e["ali:free_to_read"]="ali:free_to_read",e["ali:license_ref"]="ali:license_ref",e.altText="alt-text",e.altTitle="alt-title",e.alternatives="alternatives",e.annotation="annotation",e.anonymous="anonymous",e.answer="answer",e.answerSet="answer-set",e.app="app",e.appGroup="app-group",e.array="array",e.article="article",e.articleMeta="article-meta",e.articleTitle="article-title",e.articleVersion="article-version",e.attrib="attrib",e.authorComment="author-comment",e.awardDesc="award-desc",e.awardGroup="award-group",e.awardId="award-id",e.awardName="award-name",e.back="back",e.bio="bio",e.body="body",e.bold="bold",e.boxedText="boxed-text",e.break="break",e.caption="caption",e.chapterTitle="chapter-title",e.chemStruct="chem-struct",e.chemStructWrap="chem-struct-wrap",e.citationAlternatives="citation-alternatives",e.city="city",e.code="code",e.col="col",e.colgroup="colgroup",e.collab="collab",e.collabAlternatives="collab-alternatives",e.comment="comment",e.compoundKwd="compound-kwd",e.compoundKwdPart="compound-kwd-part",e.compoundSubject="compound-subject",e.compoundSubjectPart="compound-subject-part",e.confAcronym="conf-acronym",e.confDate="conf-date",e.confLoc="conf-loc",e.confName="conf-name",e.confNum="conf-num",e.confSponsor="conf-sponsor",e.confTheme="conf-theme",e.conference="conference",e.contrib="contrib",e.contribGroup="contrib-group",e.contribId="contrib-id",e.contributedResourceGroup="contributed-resource-group",e.copyrightHolder="copyright-holder",e.copyrightStatement="copyright-statement",e.copyrightYear="copyright-year",e.country="country",e.customMeta="custom-meta",e.customMetaGroup="custom-meta-group",e.dataTitle="data-title",e.date="date",e.dateInCitation="date-in-citation",e.day="day",e.def="def",e.defHead="def-head",e.defItem="def-item",e.defList="def-list",e.degrees="degrees",e.dispFormula="disp-formula",e.dispFormulaGroup="disp-formula-group",e.dispQuote="disp-quote",e.edition="edition",e.elementCitation="element-citation",e.elocationId="elocation-id",e.email="email",e.era="era",e.etal="etal",e.explanation="explanation",e.extLink="ext-link",e.extendedBy="extended-by",e.fax="fax",e.fig="fig",e.fixedCase="fixed-case",e.fn="fn",e.fnGroup="fn-group",e.fpage="fpage",e.front="front",e.fundingGroup="funding-group",e.fundingSource="funding-source",e.fundingStatement="funding-statement",e.givenNames="given-names",e.glossary="glossary",e.glyphData="glyph-data",e.glyphRef="glyph-ref",e.gov="gov",e.graphic="graphic",e.hr="hr",e.indexTerm="index-term",e.indexTermRangeEnd="index-term-range-end",e.inlineFormula="inline-formula",e.inlineGraphic="inline-graphic",e.inlineMedia="inline-media",e.inlineSupplementaryMaterial="inline-supplementary-material",e.institution="institution",e.institutionId="institution-id",e.institutionWrap="institution-wrap",e.isbn="isbn",e.issn="issn",e["issn-l"]="issn-l",e.issue="issue",e.issueId="issue-id",e.issuePart="issue-part",e.issueTitle="issue-title",e.italic="italic",e.journalId="journal-id",e.kwd="kwd",e.kwdGroup="kwd-group",e.label="label",e.license="license",e["license-p"]="license-p",e.list="list",e.listItem="list-item",e.longDesc="long-desc",e.lpage="lpage",e.media="media",e.metaName="meta-name",e.metaValue="meta-value",e.mixedCitation="mixed-citation",e["mml:math"]="mml:math",e.monospace="monospace",e.month="month",e.name="name",e.nameAlternatives="name-alternatives",e.namedContent="named-content",e.nestedKwd="nested-kwd",e.nlmCitation="nlm-citation",e.objectId="object-id",e.onBehalfOf="on-behalf-of",e.openAccess="open-access",e.option="option",e.overline="overline",e.p="p",e.pageCount="page-count",e.pageRange="page-range",e.partTitle="part-title",e.patent="patent",e.permissions="permissions",e.personGroup="person-group",e.phone="phone",e.postalCode="postal-code",e.prefix="prefix",e.preformat="preformat",e.price="price",e.principalAwardRecipient="principal-award-recipient",e.principalInvestigator="principal-investigator",e.privateChar="private-char",e.processingMeta="processing-meta",e.product="product",e.pubId="pub-id",e.publisherLoc="publisher-loc",e.publisherName="publisher-name",e.question="question",e.questionPreamble="question-preamble",e.questionWrap="question-wrap",e.questionWrapGroup="question-wrap-group",e.rb="rb",e.ref="ref",e.refList="ref-list",e.relatedArticle="related-article",e.relatedObject="related-object",e.resourceGroup="resource-group",e.resourceId="resource-id",e.resourceName="resource-name",e.resourceWrap="resource-wrap",e.restrictedBy="restricted-by",e.role="role",e.roman="roman",e.rt="rt",e.ruby="ruby",e.sansSerif="sans-serif",e.sc="sc",e.season="season",e.sec="sec",e.secMeta="sec-meta",e.see="see",e.seeAlso="see-also",e.selfUri="self-uri",e.series="series",e.size="size",e.source="source",e.speaker="speaker",e.speech="speech",e.state="state",e.statement="statement",e.std="std",e.stdOrganization="std-organization",e.strike="strike",e.stringDate="string-date",e.stringName="string-name",e.styledContent="styled-content",e.sub="sub",e.subjGroup="subj-group",e.subject="subject",e.subtitle="subtitle",e.suffix="suffix",e.sup="sup",e.supplement="supplement",e.supplementaryMaterial="supplementary-material",e.supportDescription="support-description",e.supportGroup="support-group",e.supportSource="support-source",e.surname="surname",e.table="table",e.tableWrap="table-wrap",e.tableWrapFoot="table-wrap-foot",e.target="target",e.tbody="tbody",e.td="td",e.term="term",e.termHead="term-head",e.textualForm="textual-form",e.tfoot="tfoot",e.th="th",e.thead="thead",e.timeStamp="time-stamp",e.title="title",e.titleGroup="title-group",e.tr="tr",e.transSource="trans-source",e.transTitle="trans-title",e.underline="underline",e.uri="uri",e.verseGroup="verse-group",e.verseLine="verse-line",e.version="version",e.volume="volume",e.volumeId="volume-id",e.volumeSeries="volume-series",e.xref="xref",e.year="year",e.subArticle="sub-article",e.articleId="article-id",e.pubDate="pub-date",e.articleCategories="article-categories",e.journalTitle="journal-title"})(ye||(ye={}));var U;(function(e){e.aff="aff",e.app="app",e.authorNote="author-note",e.award="award",e.bibr="bibr",e.bio="bio",e.boxedText="boxed-text",e.chem="chem",e.collab="collab",e.contrib="contrib",e.corresp="corresp",e.custom="custom",e.dispFormula="disp-formula",e.fig="fig",e.fn="fn",e.kwd="kwd",e.list="list",e.plate="plate",e.scheme="scheme",e.sec="sec",e.statement="statement",e.supplementaryMaterial="supplementary-material",e.table="table",e.tableFn="table-fn"})(U||(U={}));function fn(e){return e.replace(/&(?!amp;)/g,"&amp;").replace(/</g,"&lt;")}var yn=at(Be(),1);var pn=["\\?xml","article","sub-article","front","front-stub","journal-meta","journal-title-group","publisher","article-meta","article-categories","title-group","contrib-group","contrib","institution-wrap","aff","permissions","license","kwd-group","history","self-uri","funding-group","award-group","principal-award-recipient","custom-meta-group","date","pub-date","abstract","counts","body","sec","fig","statement","list","disp-formula","disp-formula-group","table-wrap","caption","table","thead","ref-list","ref","back"],hn=["journal-id","journal-title","issn","publisher-name","publisher-loc","article-id","article-title","alt-title","subtitle","kwd","name","email","contrib-id","role","institution","institution-id","award-id","meta-name","meta-value","title","p","license-p","tr","label","graphic","mixed-citation"];function pi(e){return e.replace(RegExp(`<(\\/)?(${pn.join("|")})( [^>]*)?>`,"g"),`<$1$2$3>
`).replace(RegExp(`([^
])<(\\/)?(${pn.join("|")})( [^>]*)?>`,"g"),`$1
<$2$3$4>`).replace(RegExp(`([^
])<(${hn.join("|")})( [^>]*)?>`,"g"),`$1
<$2$3>`).replace(RegExp(`<\\/(${hn.join("|")})(\\s*)>([^
])`,"g"),`</$1>
$3`)}function bn(e,t){let{format:n}={format:"pretty",...t},r=(0,yn.js2xml)(e,{compact:!1,spaces:n==="flat"||n==="pretty"?0:n||1,attributeValueFn:fn});return n===0?r.replace(/\n(\s*)</g,`
<`):n==="pretty"?pi(r):r}function hi(e,t,n){var r,l,a,s;let d=!n.type||n.type==="article-journal"?"journal":n.type,p=[],h=(r=n.author)===null||r===void 0?void 0:r.map(b=>{if(!b.given&&!b.family)return;let x=[];return b.family&&x.push({type:"element",name:"surname",elements:[{type:"text",text:b.family}]}),b.given&&x.push({type:"element",name:"given-names",elements:[{type:"text",text:b.given}]}),{type:"element",name:"name",elements:x}}).filter(b=>!!b);h&&h.length&&p.push({type:"element",name:"person-group",attributes:{"person-group-type":"author"},elements:h}),n["container-title"]&&p.push({type:"element",name:"source",elements:[{type:"text",text:n["container-title"]}]});let y=(s=(a=(l=n.issued)===null||l===void 0?void 0:l["date-parts"])===null||a===void 0?void 0:a[0])===null||s===void 0?void 0:s[0];if(y&&p.push({type:"element",name:"year",attributes:{"iso-8601-date":String(y)},elements:[{type:"text",text:String(y)}]}),n.DOI&&p.push({type:"element",name:"pub-id",attributes:{"pub-id-type":"doi"},elements:[{type:"text",text:n.DOI}]}),n.volume&&p.push({type:"element",name:"volume",elements:[{type:"text",text:n.volume}]}),n.issue&&p.push({type:"element",name:"issue",elements:[{type:"text",text:n.issue}]}),n.page){let[b,x]=n.page.split("-");b&&p.push({type:"element",name:"fpage",elements:[{type:"text",text:b}]}),x&&p.push({type:"element",name:"lpage",elements:[{type:"text",text:x}]})}return n.ISSN&&p.push({type:"element",name:"issn",elements:[{type:"text",text:n.ISSN}]}),(n.title||p.length===0)&&p.unshift({type:"element",name:"article-title",elements:n.title?[{type:"text",text:n.title}]:[]}),{type:"element",name:"ref",attributes:{id:t},elements:[{type:"element",name:"element-citation",attributes:{"publication-type":d},elements:p}]}}function yi(e,t,n){let r=t?.map(l=>{if(!n?.[l]){e.warn(`unknown citation ${l}`);return}return hi(e,l,n[l].cite)}).filter(l=>!!l);return r?.length?[{type:"element",name:"ref-list",elements:r}]:[]}function bi(e){return e?.length?[{type:"element",name:"fn-group",elements:e}]:[]}function vi(e){return e?.length?[{type:"element",name:"notes",attributes:{"notes-type":"expressions"},elements:e}]:[]}function Ue(e,{citations:t,footnotes:n,expressions:r,referenceOrder:l}){var a;let s=[...(a=e.data.backSections)!==null&&a!==void 0?a:[],...yi(e,l,t),...bi(n),...vi(r),...e.data.acknowledgments?[e.data.acknowledgments]:[]];return s.length?[{type:"element",name:"back",elements:s}]:[]}function xi(){return[]}function Ei(){let e=[];return e.length?[{type:"element",name:"journal-title-group",elements:e}]:[]}function gi(){return[]}function Ni(){return[]}function _i(){return[]}function Ai(){let e=[...xi(),...Ei(),...gi(),...Ni(),..._i()];return e.length?{type:"element",name:"journal-meta",elements:e}:null}function Ii(e){let t=e?.title,n=e?.subtitle,r=e?.short_title;if(!t&&!n&&!r)return[];let l=[{type:"element",name:"article-title",elements:t?[{type:"text",text:t}]:[]}],a=n?[{type:"element",name:"subtitle",elements:[{type:"text",text:n}]}]:[],s=r?[{type:"element",name:"alt-title",attributes:{"alt-title-type":"running-head"},elements:[{type:"text",text:r}]}]:[];return[{type:"element",name:"title-group",elements:[...l,...a,...s]}]}function Ge(e){var t,n;if(e.nameParsed&&(!((t=e.nameParsed)===null||t===void 0)&&t.given||!((n=e.nameParsed)===null||n===void 0)&&n.family)){let{given:r,family:l,dropping_particle:a,non_dropping_particle:s,suffix:d}=e.nameParsed,p=[];return l&&p.push({type:"element",name:"surname",elements:[{type:"text",text:s?`${s} ${l}`:l}]}),r&&p.push({type:"element",name:"given-names",elements:[{type:"text",text:a?`${r} ${a}`:r}]}),d&&p.push({type:"element",name:"suffix",elements:[{type:"text",text:d}]}),{type:"element",name:"name",attributes:{"name-style":"western"},elements:p}}else if(e.name)return{type:"element",name:"string-name",attributes:{"name-style":"western"},elements:[{type:"text",text:e.name}]}}function wi(e){var t;let n=(a,s)=>{let d={},p=[];s&&(d["contrib-type"]=s),a.corresponding&&(d.corresp="yes"),a.deceased&&(d.deceased="yes"),a.equal_contributor!=null&&(d["equal-contrib"]=a.equal_contributor?"yes":"no"),z.validate(a.orcid)&&p.push({type:"element",name:"contrib-id",attributes:{"contrib-id-type":"orcid"},elements:[{type:"text",text:z.buildUrl(a.orcid)}]});let h=Ge(a);return h&&p.push(h),a.roles&&p.push(...a.roles.map(y=>{let b={};return pt(y)&&(b.vocab="credit",b["vocab-identifier"]=dt,b["vocab-term"]=ft(y),b["vocab-term-identifier"]=ht(y)),{type:"element",name:"role",attributes:b,elements:[{type:"text",text:y}]}})),a.affiliations&&p.push(...a.affiliations.map(y=>({type:"element",name:"xref",attributes:{"ref-type":"aff",rid:y}}))),a.email&&p.push({type:"element",name:"email",elements:[{type:"text",text:a.email}]}),a.url&&p.push({type:"element",name:"ext-link",attributes:{"ext-link-type":"uri","xlink:href":a.url},elements:[{type:"text",text:a.url}]}),{type:"element",name:"contrib",attributes:d,elements:p}},r=((t=e.authors)!==null&&t!==void 0?t:[]).map(a=>n(a,"author")),l=[];return r.length&&l.push({type:"element",name:"contrib-group",elements:r}),l}function vn(e,t=!0){let n=[],r=[];if(e.name&&r.push({type:"element",name:"institution",elements:[{type:"text",text:e.name}]}),e.isni&&r.push({type:"element",name:"institution-id",attributes:{"institution-id-type":"isni"},elements:[{type:"text",text:e.isni}]}),e.ringgold&&r.push({type:"element",name:"institution-id",attributes:{"institution-id-type":"ringgold"},elements:[{type:"text",text:`${e.ringgold}`}]}),e.ror&&r.push({type:"element",name:"institution-id",attributes:{"institution-id-type":"ror"},elements:[{type:"text",text:e.ror}]}),e.doi){let l={"institution-id-type":"doi"};le.isOpenFunderRegistry(e.doi)&&(l.vocab="open-funder-registry"),r.push({type:"element",name:"institution-id",attributes:l,elements:[{type:"text",text:le.normalize(e.doi)}]})}return r.length&&n.push({type:"element",name:"institution-wrap",elements:r}),t&&e.department&&n.push({type:"element",name:"institution-wrap",elements:[{type:"element",name:"institution",attributes:{"content-type":"dept"},elements:[{type:"text",text:e.department}]}]}),n}function Fi(e){var t,n,r;if(!(!((t=e.affiliations)===null||t===void 0)&&t.length))return[];let l=[...new Set((r=(n=e.authors)===null||n===void 0?void 0:n.map(s=>{var d;return(d=s.affiliations)!==null&&d!==void 0?d:[]}).flat())!==null&&r!==void 0?r:[])];if(!l?.length)return[];let a=l.map(s=>{var d;return(d=e.affiliations)===null||d===void 0?void 0:d.find(p=>p.id===s)}).filter(s=>!!s).map(s=>{let d=[],p={};return s.id&&(p.id=s.id),d.push(...vn(s)),s.address&&d.push({type:"element",name:"addr-line",elements:[{type:"text",text:s.address}]}),s.city&&d.push({type:"element",name:"city",elements:[{type:"text",text:s.city}]}),s.state&&d.push({type:"element",name:"state",elements:[{type:"text",text:s.state}]}),s.postal_code&&d.push({type:"element",name:"postal-code",elements:[{type:"text",text:s.postal_code}]}),s.country&&d.push({type:"element",name:"country",elements:[{type:"text",text:s.country}]}),s.phone&&d.push({type:"element",name:"phone",elements:[{type:"text",text:s.phone}]}),s.fax&&d.push({type:"element",name:"fax",elements:[{type:"text",text:s.fax}]}),s.email&&d.push({type:"element",name:"email",elements:[{type:"text",text:s.email}]}),s.url&&d.push({type:"element",name:"ext-link",attributes:{"ext-link-type":"uri","xlink:href":s.url},elements:[{type:"text",text:s.url}]}),{type:"element",name:"aff",attributes:p,elements:d}});return a||[]}function Ci(e){var t,n,r,l,a,s,d;let p=((n=(t=e.license)===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.id)==="CC-BY-4.0",h=(a=(l=(r=e.license)===null||r===void 0?void 0:r.content)===null||l===void 0?void 0:l.url)!==null&&a!==void 0?a:(d=(s=e.license)===null||s===void 0?void 0:s.code)===null||d===void 0?void 0:d.url,y=e.open_access?[{type:"element",name:"ali:free_to_read"}]:[],b=p?[{type:"element",name:"license-p",elements:[{type:"text",text:`This ${e.open_access?"is an open access article":"article is"} distributed under the terms of the `},{type:"element",name:"ext-link",attributes:{"ext-link-type":"uri","xlink:href":"http://creativecommons.org/licenses/by/4.0/"},elements:[{type:"text",text:"Creative Commons Attribution License"}]},{type:"text",text:", which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited."}]}]:[];return h?[{type:"element",name:"permissions",elements:[...y,{type:"element",name:"license",attributes:{"xlink:href":h},elements:[{type:"element",name:"ali:license_ref",elements:[{type:"text",text:h}]},...b]}]}]:[]}function Di(e){var t;let n=(t=e.keywords)===null||t===void 0?void 0:t.map(r=>({type:"element",name:"kwd",elements:[{type:"text",text:r}]}));return n?.length?[{type:"element",name:"kwd-group",elements:n}]:[]}function ki(e){var t;let n=(t=e.funding)===null||t===void 0?void 0:t.map(r=>{var l;let a=[];return!((l=r.awards)===null||l===void 0)&&l.length&&a.push(...r.awards.map(s=>{var d,p,h;let y=[],b=(d=s.sources)===null||d===void 0?void 0:d.map(x=>{var _;return(_=e.affiliations)===null||_===void 0?void 0:_.find(O=>O.id===x)}).filter(x=>!!x);return b?.length&&y.push(...b.map(x=>({type:"element",name:"funding-source",elements:vn(x,!1)}))),s.id&&y.push({type:"element",name:"award-id",elements:[{type:"text",text:s.id}]}),s.name&&y.push({type:"element",name:"award-name",elements:[{type:"text",text:s.name}]}),s.description&&y.push({type:"element",name:"award-desc",elements:[{type:"text",text:s.description}]}),!((p=s.recipients)===null||p===void 0)&&p.length&&y.push(...s.recipients.map(x=>{var _,O,E;let D=[],G=(E=[...(_=e.authors)!==null&&_!==void 0?_:[],...(O=e.contributors)!==null&&O!==void 0?O:[]].find(k=>k.id===x))!==null&&E!==void 0?E:{name:x};z.validate(G.orcid)&&D.push({type:"element",name:"contrib-id",attributes:{"contrib-id-type":"orcid"},elements:[{type:"text",text:z.buildUrl(G.orcid)}]});let W=Ge(G);return W&&D.push(W),{type:"element",name:"principal-award-recipient",elements:D}})),!((h=s.investigators)===null||h===void 0)&&h.length&&y.push(...s.investigators.map(x=>{var _,O,E;let D=[],G=(E=[...(_=e.authors)!==null&&_!==void 0?_:[],...(O=e.contributors)!==null&&O!==void 0?O:[]].find(k=>k.id===x))!==null&&E!==void 0?E:{name:x};z.validate(G.orcid)&&D.push({type:"element",name:"contrib-id",attributes:{"contrib-id-type":"orcid"},elements:[{type:"text",text:z.buildUrl(G.orcid)}]});let W=Ge(G);return W&&D.push(W),{type:"element",name:"principal-investigator",elements:D}})),{type:"element",name:"award-group",elements:y}})),r.statement&&a.push({type:"element",name:"funding-statement",elements:[{type:"text",text:r.statement}]}),r.open_access&&a.push({type:"element",name:"open-access",elements:[{type:"element",name:"p",elements:[{type:"text",text:r.open_access}]}]}),{type:"element",name:"funding-group",elements:a}});return n||[]}function Si(e){var t;let n=(t=e.volume)===null||t===void 0?void 0:t.number;return n?[{type:"element",name:"volume",elements:[{type:"text",text:`${n}`}]}]:[]}function Ti(e){var t;let n=(t=e.issue)===null||t===void 0?void 0:t.number;return n?[{type:"element",name:"issue",elements:[{type:"text",text:`${n}`}]}]:[]}function Oi(e){let{first_page:t,last_page:n}=e??{},r=[];return t&&r.push({type:"element",name:"fpage",elements:[{type:"text",text:`${t}`}]}),n&&r.push({type:"element",name:"lpage",elements:[{type:"text",text:`${n}`}]}),r}function Pi(e){let t=[];return le.validate(e.doi)&&t.push({type:"element",name:"article-id",attributes:{"pub-id-type":"doi"},elements:[{type:"text",text:le.normalize(e.doi)}]}),t}function qe(e,t){let n=[];return e&&n.push(...Pi(e),...Ii(e),...wi(e),...Fi(e),...Si(e),...Ti(e),...Oi(e),...Ci(e)),t?.data.abstracts&&t.data.abstracts.length>0&&n.push(...t.data.abstracts),e&&n.push(...Di(e),...ki(e)),{type:"element",name:"article-meta",elements:n}}function xn(e,t){let n=[],r=Ai();r&&n.push(r);let l=qe(e,t);return n.push(l),[{type:"element",name:"front",elements:n}]}var be=["acknowledgments","acknowledgements"],ve=["abstract"];function $e(e){F("definitionList",e).forEach(r=>{let l=[],a;function s(){a&&a.children.length>0&&l.push(a),a={type:"definitionItem",children:[]}}r.children.forEach(d=>{(d.type==="definitionTerm"||!a)&&s(),a?.children.push(d)}),s(),r.children=l}),F("definitionDescription",e).forEach(r=>{let l=r.children.reduce((s,d)=>s&&d.type==="paragraph",!0),a=!!r.children.find(s=>s.type==="paragraph");l||!a||(r.children=r.children.map(s=>s.type==="paragraph"?s:{type:"paragraph",children:[s]}))})}var Li=[],X=function(e,t,n){let r=mt(n||t),l=!t||t.cascade===void 0||t.cascade===null?!0:t.cascade;return a(e);function a(s,d,p){let h=s.children||Li,y=-1,b=0;if(r(s,d,p))return null;if(h.length>0){for(;++y<h.length;)a(h[y],y,s)&&(h[b++]=h[y]);if(l&&!b)return null;h.length=b}return s}};function Ki(e){let t=Q("caption",e),n=Q("captionNumber",e);t&&X(t,"captionNumber"),n&&e.children.splice(0,0,n)}function Ve(e){F("container",e).forEach(n=>{var r,l,a,s;if(Ki(n),n.kind==="quote"){let y=Q("caption > paragraph",n),b=Q("blockquote",n);if(b&&y){let x=n;x.type="blockquote",x.children=b.children,y.type="attrib",x.children.push(y)}}let d=(r=Q("caption",n))!==null&&r!==void 0?r:{type:"caption",children:[]},p=F("legend",n);if(p.length){let y=p.map(b=>b.children).flat();d.children.push(...y),X(n,"legend")}let{identifier:h}=(a=ct((l=n.source)===null||l===void 0?void 0:l.label))!==null&&a!==void 0?a:{};h&&n.source&&d.children.push({type:"supplementaryMaterial",enumerator:n.enumerator,figIdentifier:n.identifier,sourceUrl:n.source.url,sourceSlug:n.source.slug,embedIdentifier:h}),!((s=d.children)===null||s===void 0)&&s.length&&!Q("caption",n)&&n.children.push(d),n.kind==="figure"&&(n.children=[...n.children.filter(y=>y.type.startsWith("caption")),...n.children.filter(y=>!y.type.startsWith("caption"))])})}function Xe(e){F("table",e).forEach(n=>{let r={type:"tableHead",children:[]},l={type:"tableBody",children:[]};n.children.forEach(a=>{a.children.reduce((d,p)=>d&&!!p.header,!0)&&l.children.length===0?r.children.push(a):l.children.push(a)}),n.children=r.children.length>0?[r,l]:[l]})}function We(e){let t={};if(e.kind){let n=e.kind;Object.values(we).includes(n)&&(t["sec-type"]=n)}return e.identifier&&(t.id=e.identifier),t}function Ri(e){return We(e)["sec-type"]===we.code}function ji(e){var t;return!!(!((t=e.data)===null||t===void 0)&&t["fig-cap"])}function En(e){var t;let n=[],r=[];function l(s){let d=n[n.length-1];d?d.children.push(s):r.push(s)}function a(s){let{enumerator:d,enumerated:p,...h}=s,y={...h,type:"section",children:[]};for(;n[n.length-1]&&n[n.length-1].depth>=s.depth;)n.pop();return l(y),n.push(y),{enumerator:d,enumerated:p}}(t=e.children)===null||t===void 0||t.forEach(s=>{if(s.type==="heading"){let{enumerator:d,enumerated:p}=a(s);l({type:"heading",enumerator:d,enumerated:p,children:s.children})}else l(s)}),e.children=r}function Ye(e,t){if(t?.isSubArticle){F("block",e).forEach(r=>{r.type="section",r.depth=0,En(r)});return}F("block",e).forEach(r=>{ji(r)?r.type="section":Ri(r)&&(r.type="__delete__")}),X(e,"__delete__")===null&&(e.children=[]),ut(e,"block"),En(e)}function Mi(e,t){var n,r;let l=[...be];return t.extractAbstract&&l.push(...(r=(n=t.abstractParts)===null||n===void 0?void 0:n.map(({part:a})=>a).flat())!==null&&r!==void 0?r:ve),t.backSections&&l.push(...t.backSections.map(({part:a})=>a).flat()),yt(e,l)}function He(e,t){let n=Mi(e,t);F("[visibility=remove],[visibility=hide]",e).forEach(l=>{(l.visibility==="remove"||l.visibility==="hide")&&(l.type="__delete__")}),n.forEach(l=>{l.type="block-part"}),X(e,"__delete__")===null&&(e.children=[])}function gn(e){F("block-part",e).forEach(t=>{t.type="block"})}function Nn(e){F("citeGroup",e).forEach(n=>{if(!n.children.length||n.children.filter(s=>s.type!=="cite").length)return;let{kind:r}=n;n.children.forEach(s=>{s.kind=r});let l=[];r==="parenthetical"&&l.push({type:"text",value:"("}),l.push(n.children[0]);let a=r==="parenthetical"?";":",";n.children.slice(1).forEach(s=>{l.push({type:"text",value:`${a} `},s)}),r==="parenthetical"&&l.push({type:"text",value:")"}),n.children=l})}var Bi=["figure","table","code","quote"];function te(e,t,n,r){var l;let a=(l=r[t])!==null&&l!==void 0?l:{count:0,lookup:{}};a.count+=1;let s=typeof n=="function"?n(a.count):`${n}-${a.count}`;e.identifier&&(a.lookup[e.identifier]=s),e.identifier=s,r[t]=a}function xe(e,t,n){if(F("section",e).forEach(y=>{te(y,"section","sec",t)}),F("inlineExpression",e).forEach(y=>{te(y,"expression","expr",t)}),F("math",e).forEach(y=>{te(y,"equation","eq",t)}),F("footnoteDefinition",e).forEach(y=>{te(y,"footnote","fn",t)}),F("proof",e).forEach(y=>{te(y,"proof","stm",t)}),F("container",e).forEach(y=>{!y.kind||!Bi.includes(y.kind)||te(y,y.kind,y.kind,t)}),!n)return;Object.keys(n).forEach(y=>{var b;if((b=t.cite)!==null&&b!==void 0||(t.cite={count:0,lookup:{}}),!t.cite.lookup[y]){t.cite.count+=1;let x=`ref-${t.cite.count}`;t.cite.lookup[y]=x,n[x]=n[y]}delete n[y]})}function Qe(e,t){var n,r,l,a,s,d,p,h;let y=F("crossReference",e),b={...(n=t.section)===null||n===void 0?void 0:n.lookup,...(r=t.expression)===null||r===void 0?void 0:r.lookup,...(l=t.equation)===null||l===void 0?void 0:l.lookup,...(a=t.figure)===null||a===void 0?void 0:a.lookup,...(s=t.table)===null||s===void 0?void 0:s.lookup,...(d=t.code)===null||d===void 0?void 0:d.lookup,...(p=t.quote)===null||p===void 0?void 0:p.lookup,...(h=t.proof)===null||h===void 0?void 0:h.lookup};y.forEach(E=>{E.identifier&&b[E.identifier]&&(E.identifier=b[E.identifier])}),F("supplementaryMaterial",e).forEach(E=>{E.figIdentifier&&b[E.figIdentifier]&&(E.figIdentifier=b[E.figIdentifier]),E.embedIdentifier&&b[E.embedIdentifier]&&(E.embedIdentifier=b[E.embedIdentifier])}),F("footnoteReference",e).forEach(E=>{var D;E.identifier&&(!((D=t.footnote)===null||D===void 0)&&D.lookup[E.identifier])&&(E.identifier=t.footnote.lookup[E.identifier])}),F("cite",e).forEach(E=>{var D;E.label&&(!((D=t.cite)===null||D===void 0)&&D.lookup[E.label])&&(E.label=t.cite.lookup[E.label])})}function _n(e,t){He(e,t),$e(e),Ve(e),Xe(e),Ye(e,t),Nn(e),gn(e)}function An(e,t){let n=0;e.forEach(r=>{var l,a,s;let d={};(l=r.authors)===null||l===void 0||l.forEach(p=>{var h;!((h=p.affiliations)===null||h===void 0)&&h.length&&(p.affiliations=p.affiliations.map(y=>{if(d[y])return d[y];{n+=1;let b=typeof t=="function"?t(n):`${t}-${n}`;return d[y]=b,b}}))}),(a=r.funding)===null||a===void 0||a.forEach(p=>{var h;(h=p.awards)===null||h===void 0||h.forEach(y=>{y.sources&&(y.sources=y.sources.map(b=>d[b]?d[b]:b))})}),(s=r.affiliations)===null||s===void 0||s.forEach(p=>{p.id&&d[p.id]&&(p.id=d[p.id])})})}var In=(e,t)=>{let{identifier:n,value:r}=e;t.renderInline(e,"xref",{"ref-type":"custom","custom-type":"expression",rid:n});let l={type:"element",name:"sec",attributes:{id:n,"sec-type":"expression"},elements:[{type:"element",name:"code",attributes:{executable:"yes"},elements:[{type:"text",text:r}]},{type:"element",name:"sec",attributes:{"sec-type":"notebook-output"},elements:[{type:"element",name:"p",elements:[{type:"text",text:r}]}]}]};t.warn("JATS representations of inline expressions is not complete",e),l&&t.expressions.push(l)};function kn(e){return e.replace(/&(?!amp;)/g,"&amp;").replace(/</g,"&lt;").replace(//g,"")}function Ui(e){switch(e?.split(":")[0]){case"heading":return U.sec;case"figure":return U.fig;case"subequation":case"equation":return U.dispFormula;case"table":return U.table;case"proof":return U.statement;default:return U.custom}}function Ee(e,t,n=r=>r){let{enumerated:r,enumerator:l}=e;r!==!1&&l&&(t.openNode("label"),t.text(n(l)),t.closeNode())}function wn(e,t){var n;t.openNode("alternatives"),e.output_type==="error"?(t.openNode("media",{"specific-use":"error",mimetype:"text","mime-subtype":"plain","xlink:href":e.path}),t.openNode("caption"),t.openNode("title"),t.text(e.ename),t.closeNode(),t.openNode("p"),t.text(e.evalue),t.closeNode(),t.closeNode(),t.closeNode()):e.output_type==="stream"?t.addLeaf("media",{"specific-use":"stream",mimetype:"text","mime-subtype":"plain","xlink:href":e.path}):["display_data","execute_result","update_display_data"].includes(e.output_type)&&Object.entries((n=e.data)!==null&&n!==void 0?n:{}).forEach(([r,l])=>{let a,s;r.startsWith("image/")?(a="graphic",s="print"):r==="text/html"?(a="media",s="web"):r==="text/plain"?(a="media",s="text"):(a="media",s="original-format"),t.addLeaf(a,{"specific-use":s,mimetype:r.split("/")[0],"mime-subtype":r.split("/").slice(1).join("/"),"xlink:href":l.path})}),t.closeNode()}function Sn(e){e?.name&&(e.name=`mml:${e.name}`),e?.elements&&(e.elements=e.elements.filter(t=>t.name!=="annotation"),e.elements.forEach(t=>{Sn(t)}))}function Fn(e){var t,n,r,l,a;let s=ue(e);St(new kt,s,{mathML:!0});let d=s.html?(0,Dn.xml2js)(s.html,{compact:!1}):void 0,p=(t=d?.elements)===null||t===void 0?void 0:t[0],h=(n=p?.elements)===null||n===void 0?void 0:n[0];return h?(e.type==="inlineMath"&&(h.attributes={...h.attributes,display:"inline"}),(r=h.attributes)===null||r===void 0||delete r.xmlns,Sn(h),((l=h?.elements)===null||l===void 0?void 0:l.length)===1&&h.elements[0].name==="mml:semantics"&&(h.elements=h.elements[0].elements),((a=h?.elements)===null||a===void 0?void 0:a.length)===1&&h.elements[0].name==="mml:mrow"&&(h.elements=h.elements[0].elements),h):void 0}function Cn(e){if(e)return e.split(`
`).map(t=>t.replace(/%(.*)/,"").trim()).join(" ").trim()}function Gi(e){return e?e.slice(0,1).toUpperCase()+e.slice(1):""}var qi={text(e,t){t.text(e.value)},paragraph(e,t){t.renderInline(e,"p")},section(e,t){t.renderInline(e,"sec",We(e))},heading(e,t){Ee(e,t),t.renderInline(e,"title")},block(e,t){e.visibility==="remove"||e.visibility==="hide"||t.renderChildren(e)},blockquote(e,t){t.renderInline(e,"disp-quote")},definitionList(e,t){t.renderInline(e,"def-list")},definitionItem(e,t){t.renderInline(e,"def-item")},definitionTerm(e,t){t.renderInline(e,"term")},definitionDescription(e,t){var n;t.openNode("def"),((n=e.children)===null||n===void 0?void 0:n[0].type)==="paragraph"?t.renderChildren(e):t.renderInline(e,"p"),t.closeNode()},code(e,t){let{lang:n,executable:r,identifier:l}=e,a={language:n};r&&(a.executable="yes"),l&&(a.id=l),t.renderInline(e,"code",a)},list(e,t){t.renderInline(e,"list",{"list-type":e.ordered?"order":"bullet"})},listItem(e,t){var n;t.openNode("list-item"),((n=e.children)===null||n===void 0?void 0:n[0].type)==="paragraph"?t.renderChildren(e):t.renderInline(e,"p"),t.closeNode()},thematicBreak(e,t){t.warn("The use of thematic breaks should be restricted to use inside table cells.",e,"thematicBreak",{url:"https://jats.nlm.nih.gov/archiving/tag-library/1.3/element/hr.html"})},inlineMath(e,t){let n={};e.identifier&&(n.id=e.identifier),t.openNode("inline-formula",n),t.openNode("alternatives"),t.pushNode(Fn(e)),t.openNode("tex-math"),t.addLeaf("cdata",{cdata:Cn(e.value)}),t.closeNode(),t.closeNode(),t.closeNode()},math(e,t){let n={};e.identifier&&(n.id=e.identifier),t.openNode("disp-formula",n),t.openNode("alternatives"),t.pushNode(Fn(e)),t.openNode("tex-math"),t.addLeaf("cdata",{cdata:Cn(e.value)}),t.closeNode(),t.closeNode(),Ee(e,t,r=>`(${r})`),t.closeNode()},mathGroup(e,t){let n={};e.identifier&&(n.id=e.identifier),t.openNode("disp-formula-group",n),Ee(e,t,r=>`(${r})`),t.renderChildren(e),t.closeNode()},mystRole(e,t){t.renderChildren(e)},mystDirective(e,t){t.renderChildren(e)},comment(){},strong(e,t){t.renderInline(e,"bold")},emphasis(e,t){t.renderInline(e,"italic")},underline(e,t){t.renderInline(e,"underline")},inlineCode(e,t){t.renderInline(e,"monospace")},subscript(e,t){t.renderInline(e,"sub")},superscript(e,t){t.renderInline(e,"sup")},delete(e,t){t.renderInline(e,"strike")},smallcaps(e,t){t.renderInline(e,"sc")},span(e,t){t.renderChildren(e)},break(e,t,n){if(n.type==="paragraph"||n.type==="listItem"){t.warn(`There are no breaks allowed in ${n.type}s.`,e,"break",{url:"https://jats.nlm.nih.gov/archiving/tag-library/1.3/element/break.html"});return}t.addLeaf("break")},abbreviation(e,t){t.renderInline(e,"abbrev",{alt:e.title})},link(e,t){t.renderInline(e,"ext-link",{"ext-link-type":"uri","xlink:href":e.url})},admonition(e,t){t.renderInline(e,"boxed-text",{"content-type":e.kind})},admonitionTitle(e,t){t.openNode("caption"),t.renderInline(e,"title"),t.closeNode()},attrib(e,t){t.renderInline(e,"attrib")},table(e,t){t.renderInline(e,"table")},tableHead(e,t){t.renderInline(e,"thead")},tableBody(e,t){t.renderInline(e,"tbody")},tableFooter(e,t){t.renderInline(e,"tfoot")},tableRow(e,t){t.renderInline(e,"tr")},tableCell(e,t){let{align:n,colspan:r,rowspan:l}=e;t.renderInline(e,e.header?"th":"td",{align:n,colspan:r?String(r):void 0,rowspan:l?String(l):void 0})},image(e,t){var n,r,l;!((n=e.url)===null||n===void 0)&&n.startsWith("http")&&t.warn(`Image URL is remote (${e.url})`,e,"image"),t.data.isInContainer&&e.alt&&!(!((r=e.data)===null||r===void 0)&&r.altTextIsAutoGenerated)&&(t.openNode("alt-text"),t.text(e.alt),t.closeNode());let a={mimetype:"image"},s=e.url?(l=e.url.split(".").slice(-1))===null||l===void 0?void 0:l[0]:"";s&&(a["mime-subtype"]=s),a["xlink:href"]=e.url,e.placeholder&&t.openNode("alternatives"),t.addLeaf("graphic",a),e.placeholder&&t.closeNode()},container(e,t){switch(t.data.isInContainer=!0,e.kind){case"figure":{t.renderInline(e,"fig");break}case"table":{t.renderInline(e,"table-wrap");break}case"quote":{t.renderChildren(e);break}case"code":{t.renderInline(e,"boxed-text",{"content-type":e.kind});break}default:t.error(`Unhandled container kind of ${e.kind}`,e,"container"),t.renderChildren(e)}delete t.data.isInContainer},caption(e,t){t.renderInline(e,"caption")},captionNumber(e,t){delete e.identifier,t.renderInline(e,"label")},crossReference(e,t){let{identifier:n,kind:r}=e,l={"ref-type":Ui(r),rid:n};l["ref-type"]===U.custom&&r&&(l["custom-type"]=r),t.renderInline(e,"xref",l)},citeGroup(e,t){t.renderChildren(e)},cite(e,t){let{label:n}=e,r={"ref-type":"bibr",rid:n};t.referenceOrder.includes(n)||t.referenceOrder.push(n),t.renderInline(e,"xref",r)},footnoteReference(e,t){let{identifier:n,enumerator:r}=e,l={"ref-type":"fn",rid:n};t.openNode("xref",l),t.text(r),t.closeNode()},footnoteDefinition(e,t){let{identifier:n,enumerator:r}=e;t.openNode("fn",{id:n}),t.openNode("label"),t.text(r),t.closeNode(),t.renderChildren(e);let l=t.stack.pop();l&&t.footnotes.push(l)},si(e,t){let n=e.number!=null;n&&(t.openNode("named-content",{"content-type":"quantity"}),t.text(`${e.number} `)),t.openNode("abbrev",{"content-type":"unit",alt:e.alt}),t.text(e.unit),t.closeNode(),n&&t.closeNode()},proof(e,t){var n;t.openNode("statement",{"specific-use":e.kind,id:e.identifier});let[r,...l]=(n=e.children)!==null&&n!==void 0?n:[],a=r&&r.type==="admonitionTitle";e.enumerated&&(t.openNode("label"),t.text(`${Gi(e.kind)} ${e.enumerator}`),t.closeNode()),a&&(t.openNode("title"),t.renderChildren(r),t.closeNode()),t.renderChildren(a?l:e.children),t.closeNode()},algorithmLine(e,t){t.openNode("p",{"specific-use":"line"}),e.enumerator&&(t.openNode("x"),t.text(`${e.enumerator}: `),t.closeNode()),t.text(Array(e.indent).fill("\u2003").join("")),t.renderChildren(e),t.closeNode()},output(e,t){var n,r;if(t.data.isInContainer){if(!(!((n=e.data)===null||n===void 0)&&n[0]))return;wn(e.data[0],t);return}let{identifier:l}=e,a={"sec-type":"notebook-output"};(r=e.data)===null||r===void 0||r.forEach((s,d)=>{t.openNode("sec",{...a,id:l&&!t.data.isNotebookArticleRep?`${l}-${d}`:void 0}),wn(s,t),t.closeNode()})},embed(e,t){t.data.isInContainer||t.renderChildren(e)},supplementaryMaterial(e,t){let n=e;t.openNode("p");let r={};n.figIdentifier&&(r.id=`${n.figIdentifier}-source`),r["specific-use"]="notebook",t.openNode("supplementary-material",r),Ee(e,t,l=>`Figure ${l} - Notebook.`),t.openNode("caption"),t.openNode("title"),t.text("Analysis for "),n.figIdentifier&&t.openNode("xref",{"ref-type":"fig",rid:n.figIdentifier}),t.text("Figure"+(n.enumerator?` ${n.enumerator}`:"")),n.figIdentifier&&t.closeNode(),t.text("."),t.closeNode(),t.openNode("p"),t.text("See methods"),n.sourceSlug&&(t.text(" in "),t.openNode("xref",{"ref-type":"custom","custom-type":"notebook",rid:n.sourceSlug}),t.text("notebook"),t.closeNode()),n.embedIdentifier&&(t.text(" from "),t.openNode("xref",{"ref-type":"custom","custom-type":"notebook-code",rid:n.embedIdentifier}),t.text("cell"),t.closeNode()),t.text("."),t.closeNode(),t.closeNode(),t.closeNode(),t.closeNode()},inlineExpression:In};function $i(e){return{type:"text",text:kn(e)}}function Je(e,t,n,r){let{frontmatterParts:l,...a}=r??{},s=bt(t,n,{removePartData:!0,frontmatterParts:l});return s?new ne(e,s,a).render(!0).elements():void 0}function Vi(e,t,n,r){let l=Je(e,t,n.part,r);if(!l)return;let a={type:"element",name:"abstract",elements:l};return n.title&&(a.elements=[{type:"element",name:"title",elements:[{type:"text",text:n.title}]},...a.elements]),n.type&&(a.attributes={"abstract-type":n.type}),a}function Xi(e,t,n){let r=Je(e,t,be,n);return r?{type:"element",name:"ack",elements:r}:void 0}function Wi(e,t,n,r){let l=Je(e,t,n.part,r);if(!l)return;let a={type:"element",name:"sec",elements:l};return n.title&&(a.elements=[{type:"element",name:"title",elements:[{type:"text",text:n.title}]},...a.elements]),n.type&&(a.attributes={"sec-type":n.type}),a}var ne=class{constructor(t,n,r){var l;this.file=t,this.data={isNotebookArticleRep:r?.isNotebookArticleRep,slug:r?.slug},this.stack=[{type:"element",elements:[]}],this.footnotes=[],this.expressions=[],this.referenceOrder=[],this.handlers=(l=r?.handlers)!==null&&l!==void 0?l:qi,this.mdast=ue(n),this.opts=r??{},_n(this.mdast,r??{})}render(t){var n,r,l,a;if(!t){if(!((n=this.opts)===null||n===void 0)&&n.extractAbstract){let d=(r=this.opts.abstractParts)!==null&&r!==void 0?r:ve.map(p=>({part:p}));this.data.abstracts=d.map(p=>Vi(this.file,this.mdast,p,this.opts)).filter(p=>!!p)}this.data.acknowledgments=Xi(this.file,this.mdast,this.opts);let s=(a=(l=this.opts)===null||l===void 0?void 0:l.backSections)!==null&&a!==void 0?a:[];this.data.backSections=s.map(d=>Wi(this.file,this.mdast,d,this.opts)).filter(d=>!!d)}for(this.renderChildren(this.mdast);this.stack.length>1;)this.closeNode();return this}top(){return this.stack[this.stack.length-1]}warn(t,n,r,l){ce(this.file,t,{...l,node:n,source:r?`myst-to-jats:${r}`:"myst-to-jats",ruleId:Ie.jatsRenders})}error(t,n,r,l){ce(this.file,t,{...l,node:n,source:r?`myst-to-jats:${r}`:"myst-to-jats",ruleId:Ie.jatsRenders})}pushNode(t){var n;let r=this.top();return this.stack.length&&t&&"elements"in r&&((n=r.elements)===null||n===void 0||n.push(t)),t}text(t){var n,r;let l=this.top(),a=t;if(!a||!this.stack.length||!("elements"in l))return;let s=(n=l.elements)===null||n===void 0?void 0:n[l.elements.length-1];if(s?.type==="text")return s.text+=`${kn(a)}`,s;let d=$i(a);return(r=l.elements)===null||r===void 0||r.push(d),d}renderChildren(t){let n=Array.isArray(t)?{children:t}:t,r=Array.isArray(t)?t:t.children;r?.forEach(l=>{let a=this.handlers[l.type];a?a(l,this,n):ce(this.file,`Unhandled JATS conversion for node of "${l.type}"`,{node:l,source:"myst-to-jats"})})}renderInline(t,n,r){this.openNode(n,{id:n!=="xref"&&t.identifier?t.identifier:void 0,...r}),"children"in t?this.renderChildren(t):"value"in t&&t.value&&this.text(t.value),this.closeNode()}addLeaf(t,n){this.openNode(t,n,!0),this.closeNode()}openNode(t,n,r=!1){let l=t==="cdata"?{type:"cdata",cdata:n?.cdata}:{type:"element",name:t,attributes:n};r||(l.elements=[]),this.stack.push(l)}closeNode(){let t=this.stack.pop();return this.pushNode(t)}elements(){var t;return(t=this.stack[0].elements)!==null&&t!==void 0?t:[]}},ze=class{constructor(t,n,r){this.file=t,this.options=r??{},this.content=n}article(t,n){var r,l;let a={"xmlns:mml":"http://www.w3.org/1998/Math/MathML","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:ali":"http://www.niso.org/schemas/ali/1.0/","dtd-version":"1.3","xml:lang":"en"};t&&(a["article-type"]=t),n&&(a["specific-use"]=n);let s=this.content.kind===Dt.Notebook;this.content.slug&&(a.id=`${this.content.slug}${s?"-article":""}`);let d=new ne(this.file,this.content.mdast,{...this.options,isNotebookArticleRep:s,extractAbstract:!0,frontmatterParts:(r=this.content.frontmatter)===null||r===void 0?void 0:r.parts}),p={};xe(d.mdast,p,this.content.citations);let h=(l=this.options.subArticles)!==null&&l!==void 0?l:[];s&&h.unshift({mdast:ue(this.content.mdast),kind:this.content.kind,frontmatter:this.content.frontmatter,slug:this.content.slug}),An([this.content.frontmatter,...h.map(_=>_.frontmatter)].filter(_=>!!_),"aff");let y=h.map((_,O)=>{let E=this.subArticleState(_,O===0&&s);return xe(E.mdast,p,_.citations),E});[d,...y].forEach(_=>{Qe(_.mdast,p),_.render()});let b=[...xn(this.content.frontmatter,d),this.body(d),...Ue(d,{citations:this.content.citations,footnotes:d.footnotes,expressions:d.expressions,referenceOrder:d.referenceOrder}),...y.map((_,O)=>this.subArticle(_,h[O],O===0&&s))];return{type:"element",name:ye.article,attributes:a,elements:b}}frontStub(t,n,r){var l,a;let s={};t&&Object.entries(t).forEach(([h,y])=>{var b;let x=(b=this.content.frontmatter)===null||b===void 0?void 0:b[h];(x==null||JSON.stringify(y)!==JSON.stringify(x))&&(s[h]=y)});let d=qe(s,n),p=(l=d?.elements)!==null&&l!==void 0?l:[];if(r){let h={type:"element",name:"article-version",attributes:{"article-version-type":"alt representation"},elements:[{type:"text",text:"notebook"}]};((a=p[0])===null||a===void 0?void 0:a.name)==="article-id"?p=[p[0],h,...p.slice(1)]:p.unshift(h)}return[{type:"element",name:"front-stub",elements:p}]}subArticleState(t,n){var r;return new ne(this.file,t.mdast,{...this.options,isNotebookArticleRep:!1,isSubArticle:!0,slug:t.slug,extractAbstract:!n,frontmatterParts:(r=t.frontmatter)===null||r===void 0?void 0:r.parts})}subArticle(t,n,r){let l=[...this.frontStub(n.frontmatter,t,r),{type:"element",name:"body",elements:t.elements()},...Ue(t,{citations:n.citations,footnotes:t.footnotes,expressions:t.expressions,referenceOrder:t.referenceOrder})],a={};return n.slug&&(a.id=n.slug),{type:"element",name:"sub-article",elements:l,attributes:a}}body(t){return t||(t=new ne(this.file,this.content.mdast,this.options),t.render()),{type:"element",name:"body",elements:t.elements()}}};function Yi(e,t,n){let r=new ze(e,t,n),l=n?.writeFullArticle?{type:"element",elements:[{type:"doctype",doctype:'article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN" "http://jats.nlm.nih.gov/publishing/1.3/JATS-archivearticle1-3-mathml3.dtd"'},r.article()],declaration:{attributes:{version:"1.0",encoding:"UTF-8"}}}:r.body(),a=bn(l,n);return e.result=a,e}var Hi=function(e,t,n,r,l){return this.Compiler=(a,s)=>Yi(s,{mdast:a,kind:e,frontmatter:t,citations:n,slug:r},l),a=>a},Fl=Hi;export{ze as JatsDocument,ne as JatsSerializer,Fl as default,Yi as writeJats};
/*! Bundled license information:

sax/lib/sax.js:
  (*! http://mths.be/fromcodepoint v0.1.0 by @mathias *)
*/
